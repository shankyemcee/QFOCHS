
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- css file -->

<style>
<!-- * { -->
  <!-- box-sizing: border-box; -->
<!-- } -->

.zoom {
  //padding: 50px;
  //background-color: green;
  transition: transform .2s;
  //width: 200px;
  //height: 200px;
  //margin-left: 50px;
  transform: scale(1);
  transform-origin: left;
  
}

.zoom:hover {
  -ms-transform: scale(1.5); /* IE 9 */
  -webkit-transform: scale(1.5); /* Safari 3-8 */
  transform: scale(1.5);
  //transform: translate(50px, 0px);
  //margin-left: 10px;
  //overflow: hidden;
  transform-origin: left;
}
</style>








<style>

.flex-container2 {
  //box-sizing: border-box;

//  margin: auto;
  //width: 50%;

  background-color: lightblue;
}


.inline_child {
  //display: inline-block;
  //display: grid;
  grid-template-columns: 1fr 1fr;
  
  //vertical-align: top;
  //margin-left: 10px;
}




.scrollabletextbox {
	font-size: 15px;
}





.summary {
	border: 0;
	text-align: left;
}

.text {
text-align: left;
}

.chart {
max-height: 400px;
}



mark {
  background-color: yellow;
  color: red;
}

.sample_text {
   word-wrap: break-word;
   max-width: 1300px;
}



.grid-item {
  background-color: rgba(255, 255, 255, 0.8);
  //border-bottom: 1px solid rgba(0, 0, 0, 0.8);
  padding: 10px;
  //font-size: 30px;
  text-align: center;
  
}

.item_chart {
  grid-column: 1;
  grid-row: 1 / span 2;
}

.item_line {
  border-top: 2px solid gray;
  grid-column: 1 / span 2;
  grid-row: 3;
}


.item_line2 {
  border-top: 2px solid black;
  grid-column: 1 / span 2;
  grid-row: 3;
}

.item_line_header {
  border-top: 2px solid gray;
  border-bottom: 2px solid gray;
  grid-column: 1 / span 2;
  grid-row: 3;
  font-size: 18.72px;
}


.grid_container_ui {
  display: grid;
  grid-template-rows: 1fr 1fr 1fr 1fr 1fr 1fr;
 // border-bottom: 1px solid rgba(0, 0, 0, 0.8);
  grid-gap: 10px 10px;  
  //grid-auto-columns: minmax(200px, auto);
 } 

.grid_container_headers {
  display: grid;
  grid-template-columns: 3fr ;
  grid-gap: 10px 10px;  
}


.grid_container_questions_n_answers {
  display: grid;
  grid-template-columns: 1fr 1fr;
  //grid-template-rows: 30px 30px 30px;
  grid-gap: 10px 10px;
}













</style>

<style>
body {
  text-align: center;
}
.grid-container {
  display: grid;
  grid-template-columns: 1fr 0.75fr;
  grid-template-rows: 1fr;
  gap: 5px 5px;
  grid-template-areas: "chart caption";
}

.chart { grid-area: chart; 
        align-self: center;
        text-align: center;}

.caption { grid-area: caption; 
        align-self: start;
        text-align: center;}

.text {
    text-align: left;
}

.flex-container2{
display:-webkit-flex;
display:flex;
-webkit-flex-direction:column;
flex-direction:column;
-webkit-justify-content:space-around;
justify-content:space-around;
-webkit-align-items:center;
align-items:center;
-webkit-align-content:space-around;
align-content:space-around;
}








</style>


<!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

<!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-storage.js"></script>
<!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
<script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-analytics.js"></script>

<!-- Add Firebase products that you want to use -->
<script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>


<!-- You must include this JavaScript file -->
<script>




window.addEventListener('load', function() {
    console.log('All assets loaded');
	



document.getElementById('summary1').innerHTML = tagText(document.getElementById('summary1').innerHTML);
document.getElementById('summary2').innerHTML = tagText(document.getElementById('summary2').innerHTML);
document.getElementById('summary3').innerHTML = tagText(document.getElementById('summary3').innerHTML);
document.getElementById('summary4').innerHTML = tagText(document.getElementById('summary4').innerHTML);
document.getElementById('summary5').innerHTML = tagText(document.getElementById('summary5').innerHTML);
document.getElementById('summary6').innerHTML = tagText(document.getElementById('summary6').innerHTML);







document.getElementById("summary1").onmouseup = function() {toggleHighlighter("summary1")};
document.getElementById("summary2").onmouseup = function() {toggleHighlighter("summary2")};
document.getElementById("summary3").onmouseup = function() {toggleHighlighter("summary3")};
document.getElementById("summary4").onmouseup = function() {toggleHighlighter("summary4")};
document.getElementById("summary5").onmouseup = function() {toggleHighlighter("summary5")};
document.getElementById("summary6").onmouseup = function() {toggleHighlighter("summary6")};








});








var span_tag_count = 0

function tagText(text) {

var res = text.split(" ");
console.log(res);

for (var j=0; j <  res.length; span_tag_count++,j++) {
	res[j] = "<span class='c" + span_tag_count +"'>" + res[j] + "</span>";
}


return res.join(' ');
}













function toggleHighlighter(id) {


if (window.getSelection) {

var sel = window.getSelection().toString().trim();


start_tag = window.getSelection().anchorNode.parentElement.className;

var res = sel.split(" ");


for (i=0; i < res.length; i++) {

	var tag = start_tag.slice(0, 1) + (parseInt(start_tag.slice(1)) + i).toString(); 
	
	if (document.getElementsByClassName(tag)[0].style.color == "") {
	document.getElementsByClassName(tag)[0].style.backgroundColor = "yellow";
	document.getElementsByClassName(tag)[0].style.color = "red";
	}
	else if (document.getElementsByClassName(tag)[0].style.color == "red") {
	document.getElementsByClassName(tag)[0].style.backgroundColor = "";
	document.getElementsByClassName(tag)[0].style.color = "";
	}
	
}



}

}














function resetSelection(id) {

document.getElementById(id).innerHTML = tagText(document.getElementById(id).innerText); //need to retag text to enable highlighting

}






function extractHighlightedText(id) {
element = document.getElementById(id);
text = element.innerHTML;
ele_list = element.getElementsByTagName("span");
var extracted_text = []

for (var i = 0; i < ele_list.length; i++) {
	
	if (ele_list[i].style.color == "red") {
		
		extracted_text.push(ele_list[i].innerText);
	}
	
}

try {

if (extracted_text.join(' ') ==='') { throw "error"; }

}


catch(err) {
  
	throw err;

}	






return extracted_text.join(' ');
}





function extract_user_answers(e) {

try {	

	document.getElementById("answer1").value = extractHighlightedText('summary1');
	document.getElementById("answer2").value = extractHighlightedText('summary2');
	document.getElementById("answer3").value = extractHighlightedText('summary3');
	document.getElementById("answer4").value = extractHighlightedText('summary4');
	document.getElementById("answer5").value = extractHighlightedText('summary5');
	document.getElementById("answer6").value = extractHighlightedText('summary6');

}

catch(err) {
  
	e.preventDefault();
	alert("Please highlight the answer for the question in each summary");

}	
	
}






window.onload = function() {
	document.querySelector('crowd-form').onsubmit = function(e) {
		<!-- if (!validateForm()) { -->
			<!-- alert("Please answer all the questions in order to submit."); -->
			<!-- e.preventDefault(); -->
		<!-- } -->
		<!-- else { -->
		console.log("form submit triggered");
		extract_user_answers(e);
		<!-- } -->
	}
}





//-------------------------FIREBASE STORAGE CONNECTIONS------------------------------------



// TODO: Replace the following with your app's Firebase project configuration
// For Firebase JavaScript SDK v7.20.0 and later, `measurementId` is an optional field
var firebaseConfig = {
	apiKey: "AIzaSyA8sWptiuAL6R5Cm9Rw1tweisUPusJBHI4",
    authDomain: "descriptive-qa.firebaseapp.com",
    projectId: "descriptive-qa",
    storageBucket: "descriptive-qa.appspot.com",
    messagingSenderId: "15549150456",
    appId: "1:15549150456:web:20e774076039af0475b70d"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);





// Points to the root reference
var storageRef = firebase.storage().ref();


imageDownload("samples/sample1.png", "sample1");
imageDownload("samples/sample2.png", "sample2");
imageDownload("samples/sample3.png", "sample3");


imageDownload("${img_path1}", "chart1");
imageDownload("${img_path2}", "chart2");
imageDownload("${img_path3}", "chart3");
imageDownload("${img_path4}", "chart4");
imageDownload("${img_path5}", "chart5");
imageDownload("${img_path6}", "chart6");


function imageDownload(img_path, chart_id){

//${img_path1}
// Create a reference to the file we want to download
var starsRef = storageRef.child(img_path);

// Get the download URL
starsRef.getDownloadURL()
.then((url) => {
document.getElementById(chart_id).src= url;
  // Insert url into an <img> tag to "download"
})
.catch((error) => {
  // A full list of error codes is available at
  // https://firebase.google.com/docs/storage/web/handle-errors
  switch (error.code) {
    case 'storage/object-not-found':
      // File doesn't exist
      break;
    case 'storage/unauthorized':
      // User doesn't have permission to access the object
      break;
    case 'storage/canceled':
      // User canceled the upload
      break;

    // ...

    case 'storage/unknown':
      // Unknown error occurred, inspect the server response
      break;
  }
});

}

//-------------------------FIREBASE STORAGE CONNECTIONS------------------------------------



</script>
<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>

<!-- For the full list of available Crowd HTML Elements and their input / output documentation,
    please refer to https://docs.aws.amazon.com/sagemaker/latest/dg/sms-ui-template-reference.html -->

<!-- You must include crowd - form so that your task submits answers to MTurk -->



<crowd-form answer-format="flatten-objects">


<div class="gridd-container">
  
  <div class="caption">
        <crowd-instructions link-text="View instructions" link-type="button">
            <short-summary>
                <p>Create an open ended question for which the answer is available in the given summary of the chart. Then select the answer to the question from the summary using the mouse.</p>
            </short-summary>
    
            <detailed-instructions>
               
                <p>
                  For each given chart, there is a corresponding summary that discusses about the data in the chart.
				  For each of the first 3 charts the question is already given and you need to highlight the corresponding answer from the summary.
				  For each of the next 3 charts you must create an open ended question for which the answer lies in the summary.
				  Then, you should highlight the corresponding answer from the summary. At anytime you can deselect a word from the selected answer by clicking on it.
				  You can also clear the whole selection by clicking the 'clear selection' button.
 
                </p>
				<h3>Answer Selection Criteria</h3>
				<ul>
					  <li>The answer should be atleast one sentence long</li>
					  <li>It should provide a descriptive answer to the question asked.
					  For example, ‘Describe the distribution of non-English speakers among immigrants of U.S?’ requires
					  a textual description whereas ‘What percentage of immigrants speak Arabic?’ requires just a number as an answer.</li>
					  <li>The answer should not reference any knowledge outside the data represented in the chart</li>
				</ul>
				<h3>Question Creation Criteria</h3>
				<ul>
					  <li>The question should be open ended and require a descriptive answer</li>
					  <li>The descriptive answer of the chart should answer the question</li>
				</ul>
            </detailed-instructions>
			
			
            <positive-example>
				<img id="sample1" src="" style="max-height: 200px;" class="zoom">
				
				<h4>Question 1</h4>
                <p>What was the voters opinions about Trump’s presidency ?</p>
				<h4>Answer 1</h4>
				<p class="sample_text"> The new national survey by Pew Research Center , conducted June 16 - 22 among 4,708 adults , including 3,577 registered voters ,
				finds sharp differences in how voters evaluate Trump ’s presidency compared with Biden ’s presidency , if he is elected .<mark> Very few voters – just 9 % – say
				Trump is an average president ; 37 % say he is a good or great president ; and a much larger share ( 53 % ) say he is poor or terrible , including 42 % who
				think he is a terrible president </mark>. Fewer voters ( 28 % ) say Biden would be a good or great president than say that about Trump as president . And compared
				with Trump , many more say Biden would be average ; 29 % say he would be an average president . However , 43 % say Biden would be poor or terrible , which is
				10 percentage points lower than the share expressing such negative views about Trump as president .
				 </p><p> <b>(The highlighted text in yellow answers the given question. It is a good example because the answer is descriptive in nature.)</b> </p> 
		  </positive-example>
		  <negative-example>
				<p style="padding-top: 0px;"></p>
				<h4>Question 1</h4>
                <p>How many voters say Trump is an average president ?</p>
				<h4>Answer 1</h4>
				<p class="sample_text">9%</p><p> <b>(This is not a good example question because the answer is just a number as opposed to descriptive text.)</b> </p> 	 
			</negative-example>

			
			<positive-example>
				<img id="sample2" src="" style="max-height: 200px;" class="zoom">
				<h4>Question 2</h4>
                <p>What position do Americans hold on abortion? </p>
				<h4>Answer 2</h4>
				<p class="sample_text"><mark>Though abortion is a divisive issue, more than half of U.S. adults take a non-absolutist position, saying that in
				most – but not all – cases, abortion should be legal (34%) or illegal (26%). Fewer take the position that in all cases
				abortion should be either legal (27%) or illegal (12%). </mark></p>
			</positive-example>
		    <negative-example>
				<p style="padding-top: 150px;"></p>
				<h4>Question 2</h4>
                <p>Do most Americans think abortion should be Legal?</p>
				<h4>Answer 2</h4>
				<p class="sample_text">Yes</p><p> <b>(This is not a good example question because the answer is just a single word as opposed to descriptive text.)</b> </p> 	  	
		    </negative-example>

		  
			<positive-example>
				<img id="sample3" src="" style="max-height: 200px;" class="zoom">
				<h4>Question 3</h4>
                <p>How has social media affected teenage dating? </p>
				<h4>Answer 3</h4>
				<p class="sample_text"><mark>When it comes to meeting romantic partners, most teens do this offline. Only 8% of teens say they have met a romantic partner online.</mark>
				For the small share of teen daters who have met a romantic partner over the internet, Facebook was cited more than any other social media
				site as a way that teens connect with potential partners. </p>
			</positive-example>
		    <negative-example>
				<p style="padding-top: 150px;"></p>
				<h4>Question 3</h4>
                <p>What percent of American teens prefer meeting online?</p>
				<h4>Answer 3</h4>
				<p class="sample_text">In a study of 100,000 American teens, they found that 10% of teens have met a romantic partner online.</p><p> <b>(Wrong since 100,000 American teens and 10% are not mentioned anywhere in the graph.)</b> </p> 	
		    </negative-example>
		  
		  
        </crowd-instructions>   
  </div>
</div>




<div class="grid_container_headers"> 

	<h3 class="grid-item">For the provided charts and summaries highlight answers from summaries<br><b style="font-size: 14px;">(NOTE: YOU SHOULD SELECT ALL THE RELEVANT INFORMATION FROM THE PARAGRAPH SO THAT THE ANSWER TO THE GIVEN QUESTION IS AS COMPLETE AS POSSIBLE)</b></h3>
	

</div>




<div class="grid_container_ui">  




	<div class="grid_container_questions_n_answers">  

		<div class="grid-item item_chart">
			<h3 id="title1" class="title" >${title1}</h3>
			<img class="chart zoom"  id="chart1" src=""></img>
		</div>


		<div class="grid-item">
			<h3>Question</h3>
			<div id="question1" class="text" >${question1}</div>
		</div>

		<div class="grid-item">
			<h3>Select your answer for the question above from the summary below</h3>
			
			<div id="summary1" class="summary" >${summary1}</div>
			<crowd-input name="answer1" id="answer1" placeholder="" type="hidden"></crowd-input>
			<crowd-button class='reset'onclick="resetSelection('summary1')">Clear Selection</crowd-button>
		</div>

		<div class="grid-item item_line"></div>
		


	</div>
  





	<div class="grid_container_questions_n_answers">  
	 

		<div class="grid-item item_chart">
			<h3 id="title2" class="title" >${title2}</h3>
			<img class="chart zoom"  id="chart2" src=""></img>
		</div>


		<div class="grid-item">
			<h3>Question</h3>
			<div id="question2" class="text" >${question2}</div>
		</div>

		<div class="grid-item">
			<h3>Select your answer for the question above from the summary below</h3>
			
			<div id="summary2" class="summary" >${summary2}</div>
			<crowd-input name="answer2" id="answer2" placeholder="" type="hidden"></crowd-input>
			<crowd-button class='reset' onclick="resetSelection('summary2')">Clear Selection</crowd-button>
		</div>

		<div class="grid-item item_line"></div>



	</div>
  




	<div class="grid_container_questions_n_answers">  

		<div class="grid-item item_chart">
			<h3 id="title3" class="title" >${title3}</h3>
			<img class="chart zoom"  id="chart3" src=""></img>
		</div>


		<div class="grid-item">
			<h3>Question</h3>
			<div id="question3" class="text" >${question3}</div>
		</div>



		<div class="grid-item">
			<h3>Select your answer for the question above from the summary below</h3>
			
			<div id="summary3" class="summary" >${summary3}</div>
			<crowd-input name="answer3" id="answer3" placeholder="" type="hidden"></crowd-input>
			<crowd-button class='reset' onclick="resetSelection('summary3')">Clear Selection</crowd-button>
		</div>

		<div class="grid-item item_line_header"><b>For the provided charts and summaries, create questions and highlight answers from summaries</b></div>
		
		
				





	</div>
  



 


	<div class="grid_container_questions_n_answers">  

		<div class="grid-item item_chart">
			<h3 id="title4" class="title" >${title4}</h3>
			<img class="chart zoom" id="chart4" src=""></img>
		</div>


		<div class="grid-item">  
			<h3>Create a question about the chart</h3>
			<textarea class="scrollabletextbox" name="question4" placeholder="Write a question for which the answer is in the summary" required=true rows="4" cols="100"></textarea>
			
		</div>	



		<div class="grid-item">
			<h3>Select your answer for the question above from the summary below</h3>
			
			<div id="summary4" class="summary" >${summary4}</div>
			<crowd-input name="answer4" id="answer4" placeholder="" type="hidden"></crowd-input>
			<crowd-button class='reset' onclick="resetSelection('summary4')">Clear Selection</crowd-button>
		</div>

		<div class="grid-item item_line2"></div>


	</div>







	<div class="grid_container_questions_n_answers">  	

		<div class="grid-item item_chart">
			<h3 id="title5" class="title" >${title5}</h3>
			<img class="chart zoom" id="chart5" src=""></img>
		</div>


		<div class="grid-item">  
			<h3>Create a question about the chart</h3>
			<textarea class="scrollabletextbox" name="question5" placeholder="Write a question for which the answer is in the summary" required=true rows="4" cols="100"></textarea>
			
		</div>	





		<div class="grid-item">
			<h3>Select your answer for the question above from the summary below</h3>
			
			<div id="summary5" class="summary" >${summary5}</div>
			<crowd-input name="answer5" id="answer5" placeholder="" type="hidden"></crowd-input>
			<crowd-button class='reset' onclick="resetSelection('summary5')">Clear Selection</crowd-button>
		</div>

		<div class="grid-item item_line2"></div>

		
		  

	</div>





	<div class="grid_container_questions_n_answers">  
	  

		<div class="grid-item item_chart">
			<h3 id="title6" class="title" >${title6}</h3>
			<img class="chart zoom"  id="chart6" src=""></img>
		</div>


		<div class="grid-item">  
			<h3>Create a question about the chart</h3>
			<textarea class="scrollabletextbox" name="question6" placeholder="Write a question for which the answer is in the summary" required=true rows="4" cols="100"></textarea>
			
		</div>	



		<div class="grid-item">
			<h3>Select your answer for the question above from the summary below</h3>
			
			<div id="summary6" class="summary" >${summary6}</div>
			<crowd-input name="answer6" id="answer6" placeholder="" type="hidden"></crowd-input>
			<crowd-button class='reset' onclick="resetSelection('summary6')">Clear Selection</crowd-button>
		</div>

		<div class="grid-item item_line2"></div>


		 
	</div>


</div>






<crowd-button form-action="submit" id='submit'>SUBMIT</crowd-button>

</crowd-form>

